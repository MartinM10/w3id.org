# W3ID .htaccess for dcat-ap-plus 
# DCAT-AP Plus Links to ...........................................
# Maintained by: NFDI4Chem & NFDI4Cat
# GitHub: https://github.com/nfdi-de/dcat-ap-plus 
# Contact: Koepler, Oliver <Oliver.Koepler@tib.eu>

Header set Access-Control-Allow-Origin "*"

# Enable rewrite engine
Options +FollowSymLinks
RewriteEngine on

# ====================================
# General HTML redirect to GitHub pages Documentation
# ====================================

# Default redirect to documentation (HTML)
# Matches: https://w3id.org/nfdi-de/dcat-ap-plus or https://w3id.org/nfdi-de/dcat-ap-plus
RewriteCond %{HTTP_ACCEPT} text/html [OR]
RewriteCond %{HTTP_ACCEPT} application/xhtml\+xml [OR]
RewriteCond %{HTTP_USER_AGENT} ^Mozilla/.*
RewriteRule ^$ https://nfdi-de.github.io/dcat-ap-plus/ [R=302,L]

# ====================================
# Datamodels
# ====================================

# main linkml yaml schema
RewriteCond %{HTTP_ACCEPT} application/yaml
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/dcat-ap-plus/refs/heads/main/src/dcat_ap_plus/schema/dcat_ap_plus.yaml [R=302,L]

# main python model (not pydantic)
RewriteCond %{HTTP_ACCEPT} text/x-python
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/dcat-ap-plus/refs/heads/main/src/dcat_ap_plus/datamodel/dcat_ap_plus.py [R=302,L]


# ====================================
# Various artefacts
# ====================================

# Content negotiation for LinkML excel
# xlsx format
RewriteCond %{HTTP_ACCEPT} application/Linkml\+xlsx
RewriteRule ^$ https://github.com/nfdi-de/dcat-ap-plus/raw/refs/heads/main/project/excel/dcat_ap_plus.xlsx [R=302,L]

# Content negotiation for graphql formats
# JSON format
RewriteCond %{HTTP_ACCEPT} application/graphql-response\+json
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/dcat-ap-plus/refs/heads/main/project/graphql/dcat_ap_plus.graphql [R=302,L]

# Content negotiation for JSON-LD formats
# JSON-LD format
RewriteCond %{HTTP_ACCEPT} application/schema\+json [OR]
RewriteCond %{HTTP_ACCEPT} application/json
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/dcat-ap-plus/refs/heads/main/project/jsonld/dcat_ap_plus.jsonld [R=302,L]

# Content negotiation for JSON-Schema formats
# JSON format
RewriteCond %{HTTP_ACCEPT} application/ld\+json
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/dcat-ap-plus/refs/heads/main/project/jsonschema/dcat_ap_plus.schema.json [R=302,L]

# Content negotiation for OWL formats
# TTL format
RewriteCond %{HTTP_ACCEPT} application/owl\+turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/owl\+x-turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/owl\+turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/owl\+x-turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/x-turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/x-turtle
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/dcat-ap-plus/refs/heads/main/project/owl/dcat_ap_plus.owl.ttl [R=302,L]

# Content negotiation for SHACL formats
# TTL format
RewriteCond %{HTTP_ACCEPT} application/shacl\+turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/shacl\+x-turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/shacl\+turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/shacl\+x-turtle
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/dcat-ap-plus/refs/heads/main/project/shacl/dcat_ap_plus.shacl.ttl [R=302,L]

# Content negotiation for SHEX formats
# ShExC format
RewriteCond %{HTTP_ACCEPT} application/shex\+json [OR]
RewriteCond %{HTTP_ACCEPT} text/shex
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/dcat-ap-plus/refs/heads/main/project/shex/dcat_ap_plus.shex [R=302,L]

# Content negotiation for SQLschema formats
# OWL format
RewriteCond %{HTTP_ACCEPT} application/sql
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/dcat-ap-plus/refs/heads/main/project/sqlschema/dcat_ap_plus.sql [R=302,L]

# ====================================
# Documentation redirects
# ====================================

# Documentation index
RewriteRule ^docs/?$ https://nfdi-de.github.io/dcat-ap-plus/ [R=302,L]

# Individual element documentation (example pattern)
RewriteRule ^docs/elements/(.+)$ https://nfdi-de.github.io/dcat-ap-plus/elements/$1 [R=302,L]

# ====================================
# Fallback - redirect to main documentation
# ====================================

# Catch-all: anything not matched above goes to the documentation home
RewriteRule ^(.*)$ https://nfdi-de.github.io/dcat-ap-plus/ [R=302,L]