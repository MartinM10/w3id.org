# W3ID .htaccess for chem-dcat-ap 
# DCAT-AP Plus Links to ...........................................
# Maintained by: NFDI4Chem & NFDI4Cat
# GitHub: https://github.com/nfdi-de/chem-dcat-ap 
# Contact: Koepler, Oliver <Oliver.Koepler@tib.eu>

Header set Access-Control-Allow-Origin "*"

# Enable rewrite engine
Options +FollowSymLinks
RewriteEngine on

# ====================================
# General HTML redirect to GitHub pages Documentation
# ====================================

# Default redirect to documentation (HTML)
# Matches: https://w3id.org/nfdi-de/chem-dcat-ap or https://w3id.org/nfdi-de/chem-dcat-ap
RewriteCond %{HTTP_ACCEPT} text/html [OR]
RewriteCond %{HTTP_ACCEPT} application/xhtml\+xml [OR]
RewriteCond %{HTTP_USER_AGENT} ^Mozilla/.*
RewriteRule ^$ https://nfdi-de.github.io/chem-dcat-ap/ [R=302,L]

# ====================================
# Datamodels
# ====================================

# main linkml yaml schema
RewriteCond %{HTTP_ACCEPT} application/yaml
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/chem-dcat-ap/refs/heads/main/src/dcat_4c_ap/schema/dcat_4c_ap.yaml [R=302,L]

# main python model (not pydantic)
RewriteCond %{HTTP_ACCEPT} text/x-python
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/chem-dcat-ap/refs/heads/main/src/dcat_4c_ap/datamodel/dcat_4c_ap.py [R=302,L]


# ====================================
# Various artefacts
# ====================================

# Content negotiation for LinkML excel
# xlsx format
RewriteCond %{HTTP_ACCEPT} application/Linkml\+xlsx
RewriteRule ^$ https://github.com/nfdi-de/chem-dcat-ap/raw/refs/heads/main/project/excel/dcat_4c_ap.xlsx [R=302,L]

# Content negotiation for graphql formats
# JSON format
RewriteCond %{HTTP_ACCEPT} application/graphql-response\+json
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/chem-dcat-ap/refs/heads/main/project/graphql/dcat_4c_ap.graphql [R=302,L]

# Content negotiation for JSON-LD formats
# JSON-LD format
RewriteCond %{HTTP_ACCEPT} application/schema\+json [OR]
RewriteCond %{HTTP_ACCEPT} application/json
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/chem-dcat-ap/refs/heads/main/project/jsonld/dcat_4c_ap.jsonld [R=302,L]

# Content negotiation for JSON-Schema formats
# JSON format
RewriteCond %{HTTP_ACCEPT} application/ld\+json
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/chem-dcat-ap/refs/heads/main/project/jsonschema/dcat_4c_ap.schema.json [R=302,L]

# Content negotiation for OWL formats
# TTL format
RewriteCond %{HTTP_ACCEPT} application/owl\+turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/owl\+x-turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/owl\+turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/owl\+x-turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/x-turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/x-turtle
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/chem-dcat-ap/refs/heads/main/project/owl/dcat_4c_ap.owl.ttl [R=302,L]

# Content negotiation for SHACL formats
# TTL format
RewriteCond %{HTTP_ACCEPT} application/shacl\+turtle [OR]
RewriteCond %{HTTP_ACCEPT} application/shacl\+x-turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/shacl\+turtle [OR]
RewriteCond %{HTTP_ACCEPT} text/shacl\+x-turtle
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/chem-dcat-ap/refs/heads/main/project/shacl/dcat_4c_ap.shacl.ttl [R=302,L]

# Content negotiation for SHEX formats
# ShExC format
RewriteCond %{HTTP_ACCEPT} application/shex\+json [OR]
RewriteCond %{HTTP_ACCEPT} text/shex
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/chem-dcat-ap/refs/heads/main/project/shex/dcat_4c_ap.shex [R=302,L]

# Content negotiation for SQLschema formats
# OWL format
RewriteCond %{HTTP_ACCEPT} application/sql
RewriteRule ^$ https://raw.githubusercontent.com/nfdi-de/chem-dcat-ap/refs/heads/main/project/sqlschema/dcat_4c_ap.sql [R=302,L]

# ====================================
# Documentation redirects
# ====================================

# Documentation index
RewriteRule ^docs/?$ https://nfdi-de.github.io/chem-dcat-ap/ [R=302,L]

# Individual element documentation (example pattern)
RewriteRule ^docs/elements/(.+)$ https://nfdi-de.github.io/chem-dcat-ap/elements/$1 [R=302,L]

# ====================================
# Fallback - redirect to main documentation
# ====================================

# Catch-all: anything not matched above goes to the documentation home
RewriteRule ^(.*)$ https://nfdi-de.github.io/chem-dcat-ap/ [R=302,L]